<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fahrzeuglackierer Prüfungs-App</title>
    <style>
        :root {
            --primary-color: #007bff;
            --primary-dark: #0056b3;
            --background-color: #f0f2f5;
            --card-background: #ffffff;
            --text-color: #333;
            --border-color: #e0e0e0;
            --correct-color: #28a745;
            --incorrect-color: #dc3545;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            background-color: var(--background-color);
            margin: 0;
            padding: 0;
            color: var(--text-color);
            line-height: 1.6;
        }
        .navbar {
            background-color: var(--primary-color);
            color: white;
            padding: 1.5rem;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        .nav-link {
            color: white;
            text-decoration: none;
            margin: 0 20px;
            font-weight: 600;
            cursor: pointer;
            transition: color 0.3s, border-bottom 0.3s;
        }
        .nav-link:hover {
            color: #c7e5ff;
            border-bottom: 2px solid #c7e5ff;
        }
        .page-content {
            padding: 2rem;
            max-width: 900px;
            margin: 2rem auto;
            background-color: var(--card-background);
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            display: none;
        }
        .page-content.active {
            display: block;
        }
        h1, h2 {
            color: var(--primary-dark);
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 1rem;
            font-weight: 700;
        }
        .quiz-container {
            margin-top: 2rem;
        }
        .frage {
            font-size: 1.4em;
            margin-bottom: 1.5rem;
            font-weight: 600;
        }
        .antwort-button {
            display: block;
            width: 100%;
            padding: 1rem;
            margin: 10px 0;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background-color: #f9f9f9;
            text-align: left;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.2s, box-shadow 0.2s;
            font-size: 1em;
        }
        .antwort-button:hover {
            background-color: #e9e9e9;
            transform: translateY(-2px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        .antwort-button.korrekt {
            background-color: var(--correct-color);
            color: white;
            border-color: var(--correct-color);
        }
        .antwort-button.falsch {
            background-color: var(--incorrect-color);
            color: white;
            border-color: var(--incorrect-color);
        }
        .feedback {
            margin-top: 1.5rem;
            padding: 1.5rem;
            border-radius: 8px;
            display: none;
            font-size: 1em;
        }
        .feedback.richtig {
            background-color: #d4edda;
            color: var(--correct-color);
            border: 1px solid #c3e6cb;
        }
        .feedback.falsch {
            background-color: #f8d7da;
            color: var(--incorrect-color);
            border: 1px solid #f5c6cb;
        }
        .naechste-frage-button {
            display: none;
            width: 100%;
            padding: 1rem;
            margin-top: 1.5rem;
            border: none;
            border-radius: 8px;
            background-color: var(--primary-color);
            color: white;
            font-size: 1.1em;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .naechste-frage-button:hover {
            background-color: var(--primary-dark);
        }
        #freitext-antwort {
            width: 100%;
            min-height: 150px;
            padding: 1rem;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            margin-top: 10px;
            box-sizing: border-box;
            font-size: 1em;
        }
        #zeit-anzeige {
            font-size: 1em;
            font-weight: 600;
            color: var(--incorrect-color);
            text-align: right;
            margin-bottom: 10px;
        }
        #lernfelder-liste .antwort-button {
            background-color: var(--primary-color);
            color: white;
            text-align: center;
            font-weight: 600;
        }
        #lernfelder-liste .antwort-button:hover {
            background-color: var(--primary-dark);
        }
    </style>
</head>
<body>

    <header class="navbar">
        <a class="nav-link" onclick="showPage('start')">Startseite</a>
        <a class="nav-link" onclick="showLernfelder()">Lernfelder</a>
        <a class="nav-link" onclick="startQuiz('mathematik')">Mathematik</a>
        <a class="nav-link" onclick="showPage('impressum')">Impressum</a>
    </header>

    <div id="page-start" class="page-content active">
        <h1>Willkommen bei der Fahrzeuglackierer Prüfungs-App!</h1>
        <p>Wähle im Menü ein Thema, um die Prüfungssimulation zu starten.</p>
    </div>

    <div id="page-lernfelder" class="page-content">
        <h2>Lernfelder-Übersicht</h2>
        <p>Wähle ein Lernfeld aus, um die Fragen zu starten.</p>
        <div id="lernfelder-liste">
            </div>
    </div>

    <div id="page-quiz" class="page-content">
        <h2>Prüfungsfragen</h2>
        <div id="zeit-anzeige"></div>
        <div class="quiz-container">
            <h3 class="frage" id="frage-text"></h3>
            <div id="antworten-container"></div>
            <div class="feedback" id="feedback-text"></div>
            <button class="naechste-frage-button" id="naechste-frage-button">Nächste Frage</button>
        </div>
    </div>

    <div id="page-mathematik" class="page-content">
        <h2>Mathematik-Aufgaben</h2>
        <div id="zeit-anzeige-mathe"></div>
        <div class="quiz-container">
            <h3 class="frage" id="frage-text-mathe"></h3>
            <div id="antworten-container-mathe"></div>
            <div class="feedback" id="feedback-text-mathe"></div>
            <button class="naechste-frage-button" id="naechste-frage-button-mathe">Nächste Frage</button>
        </div>
    </div>

    <div id="page-impressum" class="page-content">
        <h2>Impressum</h2>
        <p>Dies ist ein nicht-kommerzielles Prüfungstool.</p>
        <p>Verantwortlich für den Inhalt:</p>
        <p>Max Mustermann<br>
        Musterstraße 1<br>
        12345 Musterstadt</p>
        <p>Haftungsausschluss: Die bereitgestellten Informationen dienen ausschließlich zu Lernzwecken und ersetzen keine offizielle Prüfungsvorbereitung oder professionelle Beratung.</p>
    </div>

    <script>
        const alleFragen = [
            {
                "typ": "multiplechoice",
                "kategorie": "Lernfeld 1",
                "frage": "Welche Vorgehensweise ist bei der Beseitigung von Rostblüten auf einer lackierten Karosserie am wirkungsvollsten?",
                "antworten": ["Den Rost mit einem Rostumwandler behandeln und überlackieren.", "Den Rost gründlich abschleifen, die Stelle mit einem Rostschutzprimer behandeln und dann lackieren.", "Die Roststelle mit einem feinen Schleifpapier leicht anschleifen und mit Klarlack überlackieren.", "Den Rost mit einer Drahtbürste entfernen und mit einer Dickschichtspachtel abdecken."],
                "korrekteAntwortIndex": 1,
                "erklaerung": "Um Rostblüten dauerhaft zu beseitigen, muss der Rost vollständig entfernt werden. Danach muss ein Rostschutzprimer aufgetragen werden, um neuen Rost zu verhindern.",
                "quelle": "Lernfeld 1: Metallische Untergründe bearbeiten"
            },
            {
                "typ": "freitext",
                "kategorie": "Lernfeld 7",
                "frage": "Beschreibe die wichtigsten Sicherheitsvorkehrungen bei der Arbeit mit Lacken und Lösemitteln.",
                "musterantwort": "Beim Umgang mit Lacken und Lösemitteln müssen Schutzausrüstungen wie Schutzbrille, Handschuhe und Atemschutzmaske getragen werden. Der Arbeitsbereich muss gut belüftet sein, um das Einatmen schädlicher Dämpfe zu verhindern.",
                "schluesselwoerter": ["Schutzausrüstung", "Schutzbrille", "Handschuhe", "Atemschutzmaske", "belüftet", "Dämpfe"],
                "quelle": "Lernfeld 7: Reparaturlackierungen ausführen"
            },
            {
                "typ": "multiplechoice",
                "kategorie": "mathematik",
                "frage": "Wie viel Lack wird für eine Fläche von 2m² benötigt, wenn der Verbrauch 150ml pro m² beträgt?",
                "antworten": ["150 ml", "200 ml", "300 ml", "250 ml"],
                "korrekteAntwortIndex": 2,
                "erklaerung": "Die Berechnung lautet: 2 m² * 150 ml/m² = 300 ml.",
                "quelle": "Mathematik"
            },
            {
                "typ": "multiplechoice",
                "kategorie": "Lernfeld 2",
                "frage": "Welches Werkzeug eignet sich am besten zum Entfernen von Altlacken auf metallischen Oberflächen?",
                "antworten": ["Ein feines Schleifvlies.", "Ein Heißluftfön mit einer Spachtel.", "Eine Drahtbürste.", "Eine Rolle und Pinsel."],
                "korrekteAntwortIndex": 1,
                "erklaerung": "Ein Heißluftfön in Kombination mit einer Spachtel ermöglicht es, den Altlack zu erhitzen und ihn leichter abzukratzen, ohne die Oberfläche zu stark zu beschädigen.",
                "quelle": "Lernfeld 2: Nichtmetallische Untergründe bearbeiten"
            },
            {
                "typ": "multiplechoice",
                "kategorie": "mathematik",
                "frage": "Wie berechnet man den Flächeninhalt eines Rechtecks?",
                "antworten": ["Länge + Breite", "Länge * Breite", "(Länge + Breite) * 2", "Länge / Breite"],
                "korrekteAntwortIndex": 1,
                "erklaerung": "Der Flächeninhalt eines Rechtecks wird durch die Multiplikation von Länge und Breite berechnet.",
                "quelle": "Mathematik"
            }
        ];

        let aktuelleFragen = [];
        let aktuelleFrageIndex = 0;
        let timerId;

        function showPage(pageId) {
            document.querySelectorAll('.page-content').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById('page-' + pageId).classList.add('active');
        }

        function showLernfelder() {
            showPage('lernfelder');
            const lernfelderListe = document.getElementById('lernfelder-liste');
            lernfelderListe.innerHTML = '';
            
            const lernfelder = [...new Set(alleFragen.filter(f => f.kategorie !== 'mathematik').map(f => f.kategorie))];

            lernfelder.forEach(lernfeld => {
                const button = document.createElement('button');
                button.classList.add('antwort-button');
                button.textContent = lernfeld;
                button.onclick = () => startQuiz(lernfeld);
                lernfelderListe.appendChild(button);
            });
        }

        function startQuiz(kategorie) {
            aktuelleFragen = alleFragen.filter(frage => frage.kategorie === kategorie).sort(() => Math.random() - 0.5);
            aktuelleFrageIndex = 0;
            const pageId = kategorie === 'mathematik' ? 'mathematik' : 'quiz';
            showPage(pageId);
            zeigeFrage();
        }

        function startTimer(zeitInSekunden) {
            const zeitAnzeigeId = `zeit-anzeige${aktuelleFragen[0].kategorie === 'mathematik' ? '-mathe' : ''}`;
            const zeitAnzeige = document.getElementById(zeitAnzeigeId);
            
            let verbleibendeZeit = zeitInSekunden;
            zeitAnzeige.textContent = `Zeit: ${verbleibendeZeit}s`;
            
            if (timerId) clearInterval(timerId);

            timerId = setInterval(() => {
                verbleibendeZeit--;
                zeitAnzeige.textContent = `Zeit: ${verbleibendeZeit}s`;
                if (verbleibendeZeit <= 0) {
                    clearInterval(timerId);
                    gibFeedback(false, aktuelleFragen[aktuelleFrageIndex], 'Die Zeit ist abgelaufen.');
                }
            }, 1000);
        }

        function zeigeFrage() {
            const frage = aktuelleFragen[aktuelleFrageIndex];
            const prefix = frage.kategorie === 'mathematik' ? '-mathe' : '';

            const frageTextElement = document.getElementById(`frage-text${prefix}`);
            const antwortenContainer = document.getElementById(`antworten-container${prefix}`);
            const feedbackTextElement = document.getElementById(`feedback-text${prefix}`);
            const naechsteFrageButton = document.getElementById(`naechste-frage-button${prefix}`);

            antwortenContainer.innerHTML = '';
            feedbackTextElement.style.display = 'none';
            naechsteFrageButton.style.display = 'none';
            clearInterval(timerId);
            startTimer(30);

            frageTextElement.textContent = frage.frage;

            if (frage.typ === "multiplechoice") {
                frage.antworten.forEach((antwort, index) => {
                    const button = document.createElement('button');
                    button.classList.add('antwort-button');
                    button.textContent = antwort;
                    button.addEventListener('click', () => pruefeAntwort(index, frage));
                    antwortenContainer.appendChild(button);
                });
            } else if (frage.typ === "freitext") {
                const inputHtml = `
                    <textarea id="freitext-antwort" placeholder="Deine Antwort hier..."></textarea>
                    <button class="antwort-button" id="freitext-absenden">Antwort absenden</button>
                `;
                antwortenContainer.innerHTML = inputHtml;
                document.getElementById('freitext-absenden').addEventListener('click', () => {
                    const textAntwort = document.getElementById('freitext-antwort').value;
                    pruefeFreitextAntwort(textAntwort, frage);
                });
            }
        }

        function pruefeAntwort(ausgewaehlterIndex, frage) {
            clearInterval(timerId);
            const prefix = frage.kategorie === 'mathematik' ? '-mathe' : '';
            const alleButtons = document.querySelectorAll(`#antworten-container${prefix} .antwort-button`);
            alleButtons.forEach(btn => btn.removeEventListener('click', pruefeAntwort));

            if (ausgewaehlterIndex === frage.korrekteAntwortIndex) {
                alleButtons[ausgewaehlterIndex].classList.add('korrekt');
                gibFeedback(true, frage);
            } else {
                alleButtons[ausgewaehlterIndex].classList.add('falsch');
                alleButtons[frage.korrekteAntwortIndex].classList.add('korrekt');
                gibFeedback(false, frage);
            }
        }

        function pruefeFreitextAntwort(antwort, frage) {
            clearInterval(timerId);
            const antwortKlein = antwort.toLowerCase();
            let treffer = 0;
            frage.schluesselwoerter.forEach(wort => {
                if (antwortKlein.includes(wort.toLowerCase())) {
                    treffer++;
                }
            });

            const prozentTreffer = (treffer / frage.schluesselwoerter.length) * 100;
            
            if (prozentTreffer >= 60) {
                gibFeedback(true, frage, `Gut gemacht! Du hast ${treffer} von ${frage.schluesselwoerter.length} Schlüsselwörtern verwendet.`);
            } else {
                gibFeedback(false, frage, `Leider fehlen einige wichtige Punkte. Du hast nur ${treffer} von ${frage.schluesselwoerter.length} Schlüsselwörtern verwendet.`);
            }
        }

        function gibFeedback(istKorrekt, frage, zusatzText = '') {
            const prefix = frage.kategorie === 'mathematik' ? '-mathe' : '';
            const feedbackTextElement = document.getElementById(`feedback-text${prefix}`);
            const naechsteFrageButton = document.getElementById(`naechste-frage-button${prefix}`);

            feedbackTextElement.classList.remove('richtig', 'falsch');
            let text = '';
            
            if (istKorrekt) {
                feedbackTextElement.classList.add('richtig');
                text += `✅ Richtig! ${zusatzText}`;
            } else {
                feedbackTextElement.classList.add('falsch');
                text += `❌ Falsch. ${zusatzText}<br><br><strong>Erklärung:</strong> ${frage.erklaerung}`;
            }
            
            if (frage.quelle) {
                text += `<br><br><strong>Quelle:</strong> ${frage.quelle}`;
            }
            
            feedbackTextElement.innerHTML = text;
            feedbackTextElement.style.display = 'block';
            naechsteFrageButton.style.display = 'block';
            naechsteFrageButton.onclick = () => {
                aktuelleFrageIndex++;
                if (aktuelleFrageIndex < aktuelleFragen.length) {
                    zeigeFrage();
                } else {
                    const quizContainer = document.getElementById(`page-${frage.kategorie}`).querySelector('.quiz-container');
                    quizContainer.innerHTML = '<h2>Quiz beendet!</h2><p>Du hast alle Fragen beantwortet. Wähle im Menü ein neues Thema.</p>';
                    clearInterval(timerId);
                }
            };
        }

        showPage('start');
    </script>
</body>
</html>
